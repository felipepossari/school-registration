# school-registration

### Techs used
- Java 11;
- Spring Framework;
- Junit;
- Mockito;
- Lombok;
- Flyway
- MySql;
- Testcontainers;

## Requirements

In order to run this project you have to install:

- [Java 11](https://docs.aws.amazon.com/corretto/latest/corretto-11-ug/downloads-list.html);
- [Gradle](https://gradle.org/install/);
- [Docker](https://docs.docker.com/get-docker/);

## How to run with gradle

```bash  
gradle test
docker-compose up -d school-db
gradle :bootRun
```  
Note: The integration test uses testcontainer so everytime it will start a new Mysql docker container, create the schema and run the tests.

## How to run with docker

I've uploaded a docker image into Docker Hub so in order to run you just need to execute the following command in the project root folder
```bash  
docker-compose up -d
```  

## API Documentation

You can see the api docs accessing the http://localhost:8080/swagger-ui.html or opening the file `api-docs/school-registration-api-v1.0.0.json` in the site https://editor.swagger.io.

In order to help the tests there are also the Postman collection with the API calls. The Postman files are located into folder `api-docs`.

## Test Data

I've used the Flyway migration tool to create the database tables and insert some users for tests when the application starts. You can use these ids to test the application.

## Project Folder Structure
```
.
├── api-docs                                            # Folder with the API documentation generated by Swagger
├── postman                                             # Folder with the Postman collection and environment
└── src                                                 # Source code
    ├── main
    │     ├── java/com/felipepossari/schoolregistration
    │     │  ├── adapter                                # Classes responsible for receive input data from outside world like REST API
    │     │  ├── application                            # System core. Contains the business logic
    │     │  └── configuration                          # Set configurations
    │     └── resources
    └── test                                            # Test code classes
        └── java/com/felipepossari/schoolregistration
            ├── base                                    # Classes used by the tests
            ├── base                                    # Unit test classes
            └──integration                              # Integration test classes

```

The project was built thinking about clean architecture. The business logic of the system are isolated in the `application` folder and are accessible through an interface.

```
.
└── schoolregistration
    ├── adapter
    │         └── in
    │             └── web
    │         └── out
    │             └── mysql
    └── application
        ├── domain
        ├── port
        └── service
        
```

The `adapter/in` folder has the entrance for the outside world. Inside this folder are the Spring controllers and the request and response classes that allows any other system using HTTP requests.

The `adapter/out` folder has the implementation of the persistence classes. Any other classes that the business logic needs to store or send information to another systems goes here.

The `domain` folder has the classes related with the business like post and profile.

The `helper` folder has an interface to isolate the code that gets the current date time. I chose this approach to avoid use static methods in class. This way the class became testable.

The `port` folder has the interfaces used to communicate with external layers. The input interfaces stays in the `in` folder and act as use cases. The only way the adapter classes interact with the application is through the interfaces of this folder.

The output interfaces stays in the `out` folder and act as output ports. The only way the application core interacts with the outside world is through these interfaces.

The `service` folder has the implementation classes of the use case interfaces. Together with the domain classes the business logic are written.

## Linking endpoints with features

This section will show which requests need to be called in order to fill the features requested. Please open the Postman collection in order to check the requests.

- Create students CRUD:
  - `Students Folder`
- Create courses CRUD:
  - `Courses Folder`
- Create API for students to register to courses
  - Enroll -> `Enrollments -> Enroll Course`
  - Cancel Enrollment -> `Enrollments -> Cancel Enrollment`
- Create abilities for user to view all relationships between students and courses
  - `Overview folder`
+ Filter all students with a specific course
  + `Overview folder -> Students Overview: Query param: courseId `
+ Filter all courses for a specific student
  + `Overview folder -> Courses Overview: Query param: studentId `
+ Filter all courses without any students
  + `Overview folder -> Courses Overview: Query param: without-enrollment `
+ Filter all students without any courses
  + `Overview folder -> Students Overview: Query param: without-enrollment `

## Critique

The project needs more tests. Due to the time I decided to stop the tests in order to set up the docker stuffs and documentation.

Others improvements can be done like:

* Create a constant class and move the endpoints and common parameters to it. This way the code would be better organized.
* Refactor the overview endpoints and add a better search tool like Spring Specification or Graphql;


